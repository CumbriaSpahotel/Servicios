<!DOCTYPE html>
<html lang="es" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#1c1917"> <!-- Stone 900 -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description"
        content="Portal de servicios del Hotel Cumbria & Spa. Restaurante, Room Service, Spa y más.">
    <title>Cumbria Hotel & Spa | Guest Portal</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Lato:wght@300;400;700&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            --primary: #d97706;
            /* Amber 600 */
            --dark: #1c1917;
            /* Stone 900 */
        }

        body {
            font-family: system-ui, sans-serif;
            background-color: #f5f5f4;
            color: #1c1917;
            -webkit-tap-highlight-color: transparent;
            padding-bottom: env(safe-area-inset-bottom);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translate(-50%, -40%);
            }

            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.3s ease-out forwards;
        }

        h1,
        h2,
        h3,
        h4,
        .serif {
            font-family: 'Playfair Display', serif;
        }

        /* Glassmorphism */
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .glass-dark {
            background: rgba(28, 25, 23, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Utilities */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .safe-area-top {
            padding-top: env(safe-area-inset-top);
        }

        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-enter {
            animation: fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        .card-press {
            transition: transform 0.1s;
        }

        .card-press:active {
            transform: scale(0.98);
        }

        /* Modal Transitions */
        .modal-backdrop {
            transition: opacity 0.3s;
            opacity: 0;
            pointer-events: none;
        }

        .modal-backdrop.open {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            will-change: transform;
        }

        .modal-content.open {
            transform: translateY(0);
        }

        .price-dotted {
            display: flex;
            align-items: baseline;
        }

        .price-dotted .dots {
            flex: 1;
            border-bottom: 1px dotted #a8a29e;
            margin: 0 0.5rem;
        }
    </style>
</head>

<body class="bg-stone-50 select-none">

    <!-- ========== HEADER ========== -->
    <header class="relative h-[45vh] min-h-[380px] bg-stone-900 overflow-hidden rounded-b-[2.5rem] shadow-2xl z-10">
        <div class="absolute inset-0">
            <img src="https://images.unsplash.com/photo-1571896349842-68c242f9ed84?ixlib=rb-4.0.3&auto=format&fit=crop&w=1770&q=80"
                class="w-full h-full object-cover opacity-80" alt="Hotel Ambient">
            <div class="absolute inset-0 bg-gradient-to-b from-black/30 via-transparent to-stone-900"></div>
        </div>

        <div class="relative z-20 h-full flex flex-col justify-between p-6 safe-area-top">
            <!-- Top Nav -->
            <div class="flex justify-between items-center mt-2">
                <div class="glass-dark px-4 py-2 rounded-full flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                    <span class="text-white text-xs font-bold tracking-widest uppercase">Concierge</span>
                </div>
                <!-- Wifi Quick Action -->
                <button onclick="copyWifi()"
                    class="glass-dark w-10 h-10 rounded-full flex items-center justify-center text-white active:scale-95 transition">
                    <i data-lucide="wifi" class="w-5 h-5"></i>
                </button>
            </div>

            <!-- Hero Text -->
            <div class="mb-8">
                <p class="text-amber-400 text-xs font-bold tracking-[0.2em] uppercase mb-3 animate-enter"
                    style="animation-delay: 0.1s">Hotel Cumbria & Spa</p>
                <h1 class="text-4xl text-white font-serif leading-tight mb-2 animate-enter"
                    style="animation-delay: 0.2s">
                    Bienvenido a<br><span class="italic text-stone-300">su experiencia.</span>
                </h1>
                <p class="text-stone-300 text-sm max-w-[80%] animate-enter" style="animation-delay: 0.3s">
                    Todo lo que necesita, a un toque de distancia.
                </p>
            </div>
        </div>
    </header>

    <!-- ========== MAIN FEED ========== -->
    <main class="relative z-20 -mt-10 pb-32 px-4 space-y-4">

        <!-- HORIZONTAL SCROLL: QUICK ACCESS -->
        <div class="overflow-x-auto no-scrollbar flex gap-3 pb-2 -mx-4 px-4 snap-x">
            <!-- Info Hotel -->
            <!-- Info Hotel (Removed from here, moved to main grid) -->

            <!-- Minibar -->
            <button onclick="openModal('minibar-modal')" id="module-minibar"
                class="snap-start shrink-0 w-28 h-32 bg-white rounded-2xl shadow-lg shadow-stone-200/50 flex flex-col items-center justify-center gap-3 card-press border border-stone-100">
                <div class="w-10 h-10 rounded-full bg-emerald-50 flex items-center justify-center text-emerald-600">
                    <i data-lucide="wine" class="w-5 h-5"></i>
                </div>
                <div class="text-center">
                    <span class="block text-xs font-bold text-stone-800">Minibar</span>
                    <span class="text-[10px] text-stone-400">Tarifas</span>
                </div>
            </button>

            <!-- Laundry -->
            <button onclick="openModal('laundry-modal')" id="module-laundry"
                class="snap-start shrink-0 w-28 h-32 bg-white rounded-2xl shadow-lg shadow-stone-200/50 flex flex-col items-center justify-center gap-3 card-press border border-stone-100">
                <div class="w-10 h-10 rounded-full bg-cyan-50 flex items-center justify-center text-cyan-600">
                    <i data-lucide="shirt" class="w-5 h-5"></i>
                </div>
                <div class="text-center">
                    <span class="block text-xs font-bold text-stone-800">Lavandería</span>
                    <span class="text-[10px] text-stone-400">Servicios</span>
                </div>
            </button>

            <!-- Guía de Viaje (Former Tourism) -->
            <a href="turismo.html" id="module-tourism"
                class="snap-start shrink-0 w-28 h-32 bg-white rounded-2xl shadow-lg shadow-stone-200/50 flex flex-col items-center justify-center gap-3 card-press border border-stone-100 no-underline">
                <div class="w-10 h-10 rounded-full bg-rose-50 flex items-center justify-center text-rose-600">
                    <i data-lucide="map" class="w-5 h-5"></i>
                </div>
                <div class="text-center">
                    <span class="block text-xs font-bold text-stone-800">Guía de Viaje</span>
                    <span class="text-[10px] text-stone-400">Explorar</span>
                </div>
            </a>

            <!-- Map -->
            <a href="https://www.google.com/maps/search/?api=1&query=Cumbria+Spa+Hotel+Ciudad+Real" target="_blank"
                class="snap-start shrink-0 w-28 h-32 bg-white rounded-2xl shadow-lg shadow-stone-200/50 flex flex-col items-center justify-center gap-3 card-press border border-stone-100">
                <div class="w-10 h-10 rounded-full bg-orange-50 flex items-center justify-center text-orange-600">
                    <i data-lucide="navigation" class="w-5 h-5"></i>
                </div>
                <div class="text-center">
                    <span class="block text-xs font-bold text-stone-800">Mapa</span>
                    <span class="text-[10px] text-stone-400">Ir</span>
                </div>
            </a>
        </div>

        <!-- VERTICAL FEED: FEATURED SERVICES -->

        <!-- Spa (Full Width) - DESTACADO -->
        <div onclick="openModal('spa-modal')" id="module-spa"
            class="relative h-64 rounded-[2rem] overflow-hidden shadow-xl shadow-stone-300/50 card-press cursor-pointer group mb-4">
            <img src="Imagenes/spa.jpg"
                class="absolute inset-0 w-full h-full object-cover group-hover:scale-110 transition duration-1000">
            <div class="absolute inset-0 bg-stone-900/30 mix-blend-multiply"></div>

            <div class="absolute inset-0 p-6 flex flex-col justify-center items-center text-center z-10">
                <span
                    class="absolute top-6 left-6 px-2 py-1 bg-amber-500 rounded text-[10px] font-bold text-white uppercase tracking-wider shadow-lg">Destacado</span>

                <i data-lucide="droplets" class="w-10 h-10 text-white mb-3 opacity-90 filter drop-shadow-lg"></i>
                <h3 class="text-4xl text-white font-serif font-bold mb-2 shadow-black drop-shadow-md">Spa & Wellness
                </h3>
                <p class="text-white text-base mb-6 font-medium shadow-black drop-shadow-sm">Relajación absoluta</p>
                <div
                    class="px-6 py-2 bg-white/20 backdrop-blur-md border border-white/40 rounded-full text-white text-xs font-bold uppercase tracking-widest hover:bg-white/30 transition shadow-lg">
                    Más Información
                </div>
            </div>
        </div>

        <!-- ROW 1: Restaurante & Horarios -->
        <div class="grid grid-cols-2 gap-4 h-60">
            <!-- Restaurante Card -->
            <div onclick="openModal('restaurante-modal')" id="module-restaurante"
                class="relative rounded-[2rem] overflow-hidden shadow-lg card-press cursor-pointer col-span-1 group">
                <img src="Imagenes/restaurante.jpg"
                    class="absolute inset-0 w-full h-full object-cover transition duration-700 group-hover:scale-105">
                <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div>
                <div class="absolute bottom-0 p-5 w-full">
                    <h3 class="text-xl text-white font-serif font-bold leading-tight mb-1">Restaurante</h3>
                    <p class="text-[10px] text-stone-300 line-clamp-2">Alta cocina & Vinos</p>
                </div>
                <div
                    class="absolute top-4 right-4 w-8 h-8 rounded-full bg-white/20 backdrop-blur flex items-center justify-center text-white">
                    <i data-lucide="utensils" class="w-4 h-4"></i>
                </div>
            </div>

            <!-- Horarios e Info (Moved from top) -->
            <div onclick="openModal('info-modal')" id="module-info"
                class="relative rounded-[2rem] bg-stone-800 overflow-hidden shadow-lg card-press cursor-pointer col-span-1 group border border-stone-700">
                <!-- Background Image for Info (Optional, using a dark elegant texture or reception image) -->
                <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=1470&q=80"
                    class="absolute inset-0 w-full h-full object-cover opacity-60 mix-blend-overlay transition duration-700 group-hover:scale-110">

                <div class="absolute inset-0 bg-gradient-to-br from-stone-800/80 to-stone-900/40"></div>

                <div class="absolute inset-0 p-5 flex flex-col justify-between z-10">
                    <div
                        class="w-10 h-10 rounded-full bg-stone-100/10 backdrop-blur flex items-center justify-center text-stone-200 border border-white/10">
                        <i data-lucide="clock" class="w-5 h-5"></i>
                    </div>
                    <div>
                        <h3 class="text-lg text-white font-serif font-bold leading-tight mb-1">Horarios</h3>
                        <p class="text-xs text-stone-400">e Información</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ROW 2: Room Service & Cafeteria Split -->
        <div class="grid grid-cols-2 gap-4 h-60">
            <!-- Room Service -->
            <div onclick="openModal('room-service-modal')" id="module-roomService"
                class="relative rounded-[2rem] bg-stone-900 overflow-hidden shadow-lg card-press cursor-pointer col-span-1 group">
                <img src="Imagenes/Room service.jpg"
                    class="absolute inset-0 w-full h-full object-cover opacity-80 group-hover:scale-105 transition duration-700">
                <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent"></div>

                <div class="absolute inset-0 p-5 flex flex-col justify-between z-10">
                    <div
                        class="w-10 h-10 rounded-full bg-white/20 backdrop-blur flex items-center justify-center text-white border border-white/10">
                        <i data-lucide="bell-ring" class="w-5 h-5"></i>
                    </div>
                    <div>
                        <h3 class="text-lg text-white font-serif font-bold leading-tight mb-1">Room<br>Service</h3>
                        <p class="text-xs text-stone-300">Cena en la habitación</p>
                    </div>
                </div>
            </div>

            <!-- Cafetería -->
            <div onclick="openModal('cafeteria-modal')" id="module-cafeteria"
                class="relative rounded-[2rem] bg-white overflow-hidden shadow-lg card-press cursor-pointer col-span-1 border border-stone-100">
                <img src="https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?ixlib=rb-4.0.3&auto=format&fit=crop&w=1470&q=80"
                    class="absolute inset-0 w-full h-full object-cover opacity-90">
                <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                <div class="absolute inset-0 p-5 flex flex-col justify-between z-10">
                    <div
                        class="w-10 h-10 rounded-full bg-white/20 backdrop-blur flex items-center justify-center text-white">
                        <i data-lucide="coffee" class="w-5 h-5"></i>
                    </div>
                    <div>
                        <h3 class="text-lg text-white font-serif font-bold leading-tight mb-1">Cafetería</h3>
                        <p class="text-xs text-stone-300">Snacks & Café</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Link -->
        <div class="mt-8 text-center pb-24 opacity-50 hover:opacity-100 transition">
            <button onclick="goToAdmin()"
                class="text-[10px] text-stone-300 uppercase tracking-widest hover:text-stone-500">
                Admin
            </button>
        </div>
    </main>

    <!-- ========== FIXED BOTTOM BAR ========== -->
    <div class="fixed bottom-0 left-0 w-full p-4 z-50 pointer-events-none">
        <nav
            class="pointer-events-auto bg-stone-900/90 backdrop-filter backdrop-blur-xl text-white p-2 rounded-full shadow-2xl flex justify-between items-center max-w-sm mx-auto border border-white/10 safe-area-bottom">
            <a href="#"
                class="w-14 h-12 rounded-full flex flex-col items-center justify-center text-amber-500 bg-white/5">
                <i data-lucide="home" class="w-5 h-5"></i>
            </a>
            <button onclick="openModal('restaurante-modal')"
                class="w-14 h-12 rounded-full flex flex-col items-center justify-center text-stone-400 hover:text-white transition">
                <i data-lucide="utensils" class="w-5 h-5"></i>
            </button>
            <div class="w-[1px] h-6 bg-white/10"></div>
            <a href="turismo.html"
                class="w-14 h-12 rounded-full flex flex-col items-center justify-center text-stone-400 hover:text-amber-600 transition">
                <i data-lucide="compass" class="w-6 h-6 mb-1"></i>
                <span class="text-[10px] font-bold">Guía</span>
            </a>
            <a href="tel:+34926000000"
                class="w-14 h-12 rounded-full flex flex-col items-center justify-center text-stone-400 hover:bg-emerald-600 hover:text-white transition">
                <i data-lucide="phone" class="w-5 h-5"></i>
            </a>
        </nav>
    </div>


    <!-- ========== MODALS ========== -->

    <!-- TEMPLATE: Info Modal -->
    <div id="info-modal" class="fixed inset-0 z-[60] flex items-end justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/60 modal-backdrop" onclick="closeModal('info-modal')"></div>
        <div
            class="modal-content relative w-full h-[90vh] bg-stone-50 rounded-t-[2.5rem] overflow-hidden pointer-events-auto flex flex-col shadow-2xl">
            <!-- Header -->
            <div class="relative shrink-0 p-6 flex justify-between items-center bg-white z-20">
                <h2 class="text-2xl font-serif font-bold text-stone-900">Información</h2>
                <button onclick="closeModal('info-modal')"
                    class="w-8 h-8 rounded-full bg-stone-100 flex items-center justify-center text-stone-500 hover:bg-stone-200">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>

            <!-- Body -->
            <div class="flex-1 overflow-y-auto p-6 space-y-6 bg-stone-50 pb-24">

                <p class="text-stone-600 text-sm text-center italic mb-4">
                    "Es un placer recibirle. Esperamos que se sienta como en casa."
                </p>

                <!-- Reception -->
                <div class="bg-white p-5 rounded-3xl shadow-sm">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="bg-stone-100 p-2 rounded-xl"><i data-lucide="bell"
                                class="w-5 h-5 text-stone-700"></i></div>
                        <h4 class="font-bold text-stone-800">Recepción 24h</h4>
                    </div>
                    <p class="text-sm text-stone-500 leading-relaxed mb-4" id="info-reception-text">...</p>
                    <a href="tel:1198"
                        class="flex items-center justify-between p-3 bg-stone-50 rounded-xl border border-stone-100 text-sm font-bold text-stone-700">
                        <span>Llamar <span id="info-reception-phone">...</span></span>
                        <i data-lucide="phone-call" class="w-4 h-4 text-emerald-600"></i>
                    </a>
                </div>

                <!-- Breakfast -->
                <div class="bg-white p-5 rounded-3xl shadow-sm">
                    <div class="flex items-center gap-3 mb-3">
                        <div class="bg-amber-100 p-2 rounded-xl"><i data-lucide="coffee"
                                class="w-5 h-5 text-amber-700"></i></div>
                        <h4 class="font-bold text-stone-800">Desayuno Buffet</h4>
                    </div>
                    <p class="text-xs text-stone-400 mb-3" id="info-breakfast-loc">...</p>
                    <div class="space-y-3">
                        <div class="flex justify-between text-sm border-b border-stone-100 pb-2">
                            <span class="text-stone-500">Lunes - Viernes</span>
                            <span class="font-bold text-stone-800" id="info-breakfast-week">...</span>
                        </div>
                        <div class="flex justify-between text-sm border-b border-stone-100 pb-2">
                            <span class="text-stone-500">Fines de Semana</span>
                            <span class="font-bold text-stone-800" id="info-breakfast-weekend">...</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-stone-500">Precio</span>
                            <span class="font-bold text-amber-600"><span id="info-breakfast-price">...</span>€ /
                                persona</span>
                        </div>
                    </div>
                </div>

                <!-- Restaurants & Bars Info -->
                <div class="bg-white p-5 rounded-3xl shadow-sm space-y-4">
                    <div>
                        <h4 class="font-bold text-stone-800 text-sm mb-1">Restaurante</h4>
                        <p class="text-xs text-stone-500" id="info-restaurant-lunch">Comidas: ...</p>
                        <p class="text-xs text-stone-500" id="info-restaurant-dinner">Cenas: ...</p>
                    </div>
                    <div class="border-t pt-2">
                        <h4 class="font-bold text-stone-800 text-sm mb-1">Cafetería</h4>
                        <p class="text-xs text-stone-500" id="info-cafeteria-schedule">...</p>
                    </div>
                    <div class="border-t pt-2">
                        <h4 class="font-bold text-stone-800 text-sm mb-1">Room Service</h4>
                        <p class="text-xs text-stone-500" id="info-roomservice-schedule">...</p>
                    </div>
                </div>

                <!-- Pool & Gym -->
                <div class="grid grid-cols-1 gap-4">
                    <div class="bg-white p-5 rounded-3xl shadow-sm flex items-center gap-4">
                        <div class="bg-cyan-50 p-2 rounded-xl"><i data-lucide="waves" class="w-5 h-5 text-cyan-600"></i>
                        </div>
                        <div>
                            <h4 class="font-bold text-stone-800 text-sm">Piscina</h4>
                            <p class="text-xs text-stone-500 mt-1" id="info-pool-desc">...</p>
                            <p class="text-xs text-stone-400" id="info-pool-schedule">...</p>
                        </div>
                    </div>
                    <div class="bg-white p-5 rounded-3xl shadow-sm">
                        <div class="flex items-center gap-3 mb-2">
                            <div class="bg-stone-100 p-2 rounded-xl"><i data-lucide="dumbbell"
                                    class="w-5 h-5 text-stone-800"></i></div>
                            <h4 class="font-bold text-stone-800 text-sm">Gimnasio</h4>
                        </div>
                        <p class="text-xs text-stone-500 mb-2 leading-relaxed" id="info-gym-desc">...</p>
                        <p class="text-xs text-stone-400 font-mono" id="info-gym-schedule">...</p>
                    </div>
                </div>

                <!-- Parking -->
                <div class="bg-white p-5 rounded-3xl shadow-sm flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="bg-stone-100 p-2 rounded-xl"><i data-lucide="car"
                                class="w-5 h-5 text-stone-600"></i></div>
                        <div>
                            <h4 class="font-bold text-stone-800 text-sm">Parking</h4>
                            <p class="text-xs text-stone-500 max-w-[200px]" id="info-parking-desc">...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- TEMPLATE: Restaurante Modal -->
    <div id="restaurante-modal" class="fixed inset-0 z-[60] flex items-end justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/60 modal-backdrop" onclick="closeModal('restaurante-modal')"></div>
        <div
            class="modal-content relative w-full h-[95vh] bg-stone-50 rounded-t-[2.5rem] overflow-hidden pointer-events-auto flex flex-col shadow-2xl">
            <!-- Visual Header -->
            <div class="relative h-60 shrink-0">
                <img src="Imagenes/restaurante.jpg" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                <button onclick="closeModal('restaurante-modal')"
                    class="absolute top-6 right-6 w-10 h-10 rounded-full bg-white/20 backdrop-blur flex items-center justify-center text-white hover:bg-white/30 z-20">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
                <div class="absolute bottom-6 left-6 text-white">
                    <span
                        class="px-2 py-1 border border-white/30 rounded text-[10px] uppercase font-bold tracking-widest mb-2 inline-block">Menú</span>
                    <h2 class="text-3xl font-serif font-bold">Restaurante</h2>
                </div>
            </div>

            <!-- Content -->
            <div class="flex-1 overflow-y-auto p-6 bg-stone-50 space-y-8 pb-32">

                <p class="text-stone-500 italic text-center font-serif text-lg px-4" id="restaurante-desc">
                    Loading...
                </p>

                <!-- DYNAMIC CONTENT CONTAINER -->
                <div id="restaurante-list" class="space-y-6"></div>

                <div class="text-center text-xs text-stone-400 pb-4" id="restaurante-schedule">
                    Horario: ...
                </div>

            </div>
        </div>
    </div>

    <!-- TEMPLATE: Room Service Modal -->
    <div id="room-service-modal" class="fixed inset-0 z-[60] flex items-end justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/60 modal-backdrop" onclick="closeModal('room-service-modal')"></div>
        <div
            class="modal-content relative w-full h-[95vh] bg-stone-50 rounded-t-[2.5rem] overflow-hidden pointer-events-auto flex flex-col shadow-2xl">
            <!-- Header -->
            <div class="bg-stone-900 p-6 pt-8 text-white rounded-b-[2rem] shadow-lg relative z-10">
                <button onclick="closeModal('room-service-modal')"
                    class="absolute top-6 right-6 w-8 h-8 rounded-full bg-white/10 flex items-center justify-center text-white hover:bg-white/20">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
                <div class="flex items-center gap-3 mb-2">
                    <div class="p-2 bg-amber-500 rounded-lg"><i data-lucide="bell-ring" class="w-5 h-5 text-white"></i>
                    </div>
                    <span class="text-xs font-bold uppercase tracking-widest text-amber-500" id="rs-ext">Extensión
                        ...</span>
                </div>
                <h2 class="text-3xl font-serif font-bold">Room Service</h2>
            </div>

            <!-- Content -->
            <div class="flex-1 overflow-y-auto p-6 bg-stone-50 space-y-6 pb-24">

                <!-- DYNAMIC CONTENT CONTAINER -->
                <div id="rs-list" class="space-y-6"></div>

                <p class="text-[10px] text-center text-stone-400" id="rs-surcharge">Suplemento servicio habitaciones:
                    ...</p>
            </div>
        </div>
    </div>

    <!-- TEMPLATE: Cafeteria Modal -->
    <div id="cafeteria-modal" class="fixed inset-0 z-[60] flex items-end justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/60 modal-backdrop" onclick="closeModal('cafeteria-modal')"></div>
        <div
            class="modal-content relative w-full h-[60vh] bg-stone-50 rounded-t-[2.5rem] overflow-hidden pointer-events-auto flex flex-col shadow-2xl">
            <!-- Header -->
            <div class="p-6 bg-white border-b border-stone-100 flex justify-between items-center">
                <h2 class="text-2xl font-serif font-bold text-stone-900">Cafetería</h2>
                <button onclick="closeModal('cafeteria-modal')"
                    class="w-8 h-8 rounded-full bg-stone-100 flex items-center justify-center text-stone-500 hover:bg-stone-200">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="flex-1 overflow-y-auto p-6 bg-stone-50 space-y-6">
                <div class="bg-amber-50 p-4 rounded-2xl flex items-center gap-4">
                    <div class="bg-white p-2 rounded-full shadow-sm"><i data-lucide="clock"
                            class="w-5 h-5 text-amber-600"></i></div>
                    <div>
                        <p class="font-bold text-amber-900 text-sm">Abierto todos los días</p>
                        <p class="text-xs text-amber-700" id="cafe-schedule">...</p>
                    </div>
                </div>

                <div class="bg-white rounded-2xl p-5 shadow-sm space-y-3" id="cafe-list">
                    <!-- Dynamic -->
                </div>
            </div>
        </div>
    </div>

    <!-- TEMPLATE: Spa Modal -->
    <div id="spa-modal" class="fixed inset-0 z-[60] flex items-end justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/60 modal-backdrop" onclick="closeModal('spa-modal')"></div>
        <div
            class="modal-content relative w-full h-[95vh] bg-stone-50 rounded-t-[2.5rem] overflow-hidden pointer-events-auto flex flex-col shadow-2xl">
            <!-- Header Image -->
            <div class="relative h-64 shrink-0">
                <img id="spa-header-img" src="Imagenes/spa.jpg" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-t from-stone-900 via-transparent to-transparent"></div>
                <!-- Close -->
                <button onclick="closeModal('spa-modal')"
                    class="absolute top-6 right-6 w-10 h-10 rounded-full bg-black/20 backdrop-blur flex items-center justify-center text-white hover:bg-black/40 z-20">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
                <div class="absolute bottom-6 left-6 text-white w-full pr-12">
                    <div class="flex items-center gap-2 mb-2">
                        <i data-lucide="droplets" class="w-5 h-5 text-cyan-300"></i>
                        <span class="text-cyan-100 text-xs font-bold uppercase tracking-widest">Wellness Zone</span>
                    </div>
                    <h2 class="text-3xl font-serif font-bold">Circuito Termal</h2>
                </div>
            </div>

            <!-- Content -->
            <div class="flex-1 overflow-y-auto p-6 bg-stone-50 space-y-8 pb-32">

                <div class="space-y-6 text-stone-600 text-sm leading-relaxed">
                    <!-- Intro -->
                    <div class="border-l-4 border-amber-500 pl-4 py-1 bg-gradient-to-r from-amber-50 to-transparent">
                        <h3 class="font-serif font-bold text-2xl text-stone-800 mb-1">Relájate y disfruta</h3>
                        <p class="text-stone-500 italic">Desconecta, relaja tu cuerpo y purifícate.</p>
                    </div>

                    <p>
                        ¿Te gustaría desconectar, relajar tu cuerpo y purificarte de toxinas? ¡Es el momento perfecto
                        para un tratamiento termal! El agua será tu mejor aliada en esta experiencia de bienestar.
                    </p>

                    <!-- Feature Cards -->
                    <div class="grid grid-cols-1 gap-4 bg-stone-100/50 p-4 rounded-xl border border-stone-100">
                        <!-- Card 1 -->
                        <div class="flex gap-4 items-start">
                            <div
                                class="shrink-0 w-10 h-10 rounded-full bg-cyan-100 flex items-center justify-center text-cyan-600 shadow-sm">
                                <i data-lucide="droplets" class="w-5 h-5"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-stone-800 text-xs uppercase tracking-wide mb-1">Hidroterapia
                                    Natural</h4>
                                <p class="text-xs text-stone-500 leading-snug">
                                    Técnica que utiliza el agua a diferentes temperaturas para activar las funciones
                                    vitales. Alternando entre chorros y baños para <strong
                                        class="text-cyan-600">revitalizar</strong> profundamente.
                                </p>
                            </div>
                        </div>

                        <div class="h-px bg-stone-200 w-full"></div>

                        <!-- Card 2 -->
                        <div class="flex gap-4 items-start">
                            <div
                                class="shrink-0 w-10 h-10 rounded-full bg-rose-100 flex items-center justify-center text-rose-600 shadow-sm">
                                <i data-lucide="activity" class="w-5 h-5"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-stone-800 text-xs uppercase tracking-wide mb-1">Beneficios
                                    Térmicos</h4>
                                <p class="text-xs text-stone-500 leading-snug">
                                    El <span class="font-bold text-rose-500">calor</span> dilata y mejora la
                                    circulación. El <span class="font-bold text-cyan-500">frío</span> contrae y
                                    tonifica. Un equilibrio perfecto que impulsa el retorno venoso y alivia tensiones.
                                </p>
                            </div>
                        </div>
                    </div>

                    <p>
                        Estos estímulos térmicos sobre la piel generan respuestas que equilibran tu cuerpo y
                        proporcionan una profunda sensación de bienestar.
                    </p>

                    <div class="bg-amber-50 p-6 rounded-xl text-center border border-amber-100 shadow-sm">
                        <p class="font-serif font-bold text-amber-800 text-lg italic">
                            "¡Sumérgete en el poder del agua y siente cómo tu cuerpo se revitaliza!"
                        </p>
                    </div>
                </div>

                <!-- Video -->
                <div
                    class="relative w-full aspect-video rounded-2xl overflow-hidden shadow-lg bg-black ring-4 ring-stone-100">
                    <iframe id="spa-video-frame" class="absolute top-0 left-0 w-full h-full"
                        src="https://www.youtube.com/embed/lE6RYpe9IT0?rel=0&modestbranding=1" title="Spa Relax"
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen></iframe>
                </div>

                <!-- Facilities -->
                <div class="grid grid-cols-2 gap-3">
                    <div class="bg-white p-4 rounded-2xl shadow-sm text-center">
                        <i data-lucide="waves" class="w-6 h-6 text-cyan-600 mx-auto mb-2"></i>
                        <span class="text-xs font-bold text-stone-700">Hidromasaje</span>
                    </div>
                    <div class="bg-white p-4 rounded-2xl shadow-sm text-center">
                        <i data-lucide="thermometer-sun" class="w-6 h-6 text-orange-500 mx-auto mb-2"></i>
                        <span class="text-xs font-bold text-stone-700">Sauna</span>
                    </div>
                    <div class="bg-white p-4 rounded-2xl shadow-sm text-center">
                        <i data-lucide="cloud-fog" class="w-6 h-6 text-stone-400 mx-auto mb-2"></i>
                        <span class="text-xs font-bold text-stone-700">Baño Turco</span>
                    </div>
                    <div class="bg-white p-4 rounded-2xl shadow-sm text-center">
                        <i data-lucide="snowflake" class="w-6 h-6 text-blue-400 mx-auto mb-2"></i>
                        <span class="text-xs font-bold text-stone-700">Hielo</span>
                    </div>
                </div>

                <!-- Prices -->
                <div class="bg-stone-900 rounded-3xl p-6 text-white shadow-lg">
                    <h3 class="font-serif font-bold text-lg mb-4 text-center">Tarifas Circuito (1h)</h3>
                    <div class="flex justify-between items-center border-b border-white/10 pb-4 mb-4">
                        <div class="text-left">
                            <span class="block font-bold text-amber-500 text-sm">Lunes - Jueves</span>
                            <span class="text-[10px] text-stone-400">Días laborables</span>
                        </div>
                        <span class="text-2xl font-bold" id="spa-price-week">--€</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <div class="text-left">
                            <span class="block font-bold text-white text-sm">Viernes - Domingo</span>
                            <span class="text-[10px] text-stone-400">Festivos incluidos</span>
                        </div>
                        <span class="text-2xl font-bold" id="spa-price-weekend">--€</span>
                    </div>
                </div>

                <div class="bg-orange-50 p-4 rounded-xl border border-orange-100 flex gap-3 items-start">
                    <i data-lucide="info" class="w-5 h-5 text-orange-500 shrink-0 mt-0.5"></i>
                    <p class="text-xs text-orange-800 leading-snug">
                        <strong>Importante:</strong> Uso obligatorio de gorro (<span id="spa-cap">...</span>€) y
                        chanclas (<span id="spa-flip">...</span>€). Disponibles para compra o alquiler.
                    </p>
                </div>

            </div>

            <div class="absolute bottom-0 w-full p-6 bg-gradient-to-t from-stone-50 via-stone-50 to-transparent">
                <a href="https://wa.me/34926233364" target="_blank"
                    class="block w-full py-4 bg-[#25D366] rounded-xl text-white font-bold text-center shadow-lg shadow-green-500/20 hover:brightness-105 transition flex items-center justify-center gap-2">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg"
                        class="w-6 h-6 brightness-0 invert">
                    Reserva tu momento Spa
                </a>
            </div>
        </div>
    </div>

    <!-- TEMPLATE: Minibar Modal -->
    <div id="minibar-modal" class="fixed inset-0 z-[60] flex items-end justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/60 modal-backdrop" onclick="closeModal('minibar-modal')"></div>
        <div
            class="modal-content relative w-full h-[60vh] bg-stone-50 rounded-t-[2.5rem] overflow-hidden pointer-events-auto flex flex-col shadow-2xl">
            <div class="p-6 bg-white border-b border-stone-100 flex justify-between items-center">
                <h2 class="text-2xl font-serif font-bold text-stone-900">Minibar</h2>
                <button onclick="closeModal('minibar-modal')"
                    class="w-8 h-8 rounded-full bg-stone-100 flex items-center justify-center text-stone-500 hover:bg-stone-200">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="flex-1 overflow-y-auto p-6 bg-stone-50 space-y-6">
                <p id="minibar-desc" class="text-sm text-stone-600 italic text-center"></p>
                <!-- Dynamic -->
                <div id="minibar-list" class="space-y-6"></div>
            </div>
        </div>
    </div>

    <!-- TEMPLATE: Tourism Modal -->
    <div id="tourism-modal" class="fixed inset-0 z-[60] flex items-end justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/80 modal-backdrop" onclick="closeModal('tourism-modal')"></div>
        <div
            class="modal-content relative w-full h-[50vh] bg-stone-900 rounded-t-[2.5rem] overflow-hidden pointer-events-auto flex flex-col shadow-2xl">
            <div class="p-6 bg-stone-900 border-b border-white/10 flex justify-between items-center shrink-0">
                <h2 class="text-xl font-serif font-bold text-white flex items-center gap-2">
                    <i data-lucide="youtube" class="w-5 h-5 text-red-500"></i> Turismo en Ciudad Real
                </h2>
                <button onclick="closeModal('tourism-modal')"
                    class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center text-white hover:bg-white/20">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="flex-1 bg-black flex items-center justify-center relative">
                <iframe id="tourism-frame" class="w-full h-full absolute inset-0" src="" title="YouTube video player"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowfullscreen></iframe>
            </div>
        </div>
    </div>

    <!-- TEMPLATE: Laundry Modal -->
    <div id="laundry-modal" class="fixed inset-0 z-[60] flex items-end justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/60 modal-backdrop" onclick="closeModal('laundry-modal')"></div>
        <div
            class="modal-content relative w-full h-[60vh] bg-stone-50 rounded-t-[2.5rem] overflow-hidden pointer-events-auto flex flex-col shadow-2xl">
            <div class="p-6 bg-white border-b border-stone-100 flex justify-between items-center">
                <h2 class="text-2xl font-serif font-bold text-stone-900">Lavandería</h2>
                <button onclick="closeModal('laundry-modal')"
                    class="w-8 h-8 rounded-full bg-stone-100 flex items-center justify-center text-stone-500 hover:bg-stone-200">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="flex-1 overflow-y-auto p-6 bg-stone-50 space-y-6">

                <div class="bg-blue-50 p-4 rounded-2xl flex gap-3 items-center">
                    <i data-lucide="zap" class="w-5 h-5 text-blue-600"></i>
                    <p class="text-xs font-bold text-blue-900">Servicio Express disponible (+50%)</p>
                </div>

                <div id="laundry-info"
                    class="text-sm text-stone-600 leading-relaxed bg-white p-4 rounded-2xl shadow-sm border border-stone-100 hidden">
                </div>

                <div class="bg-white rounded-2xl p-5 shadow-sm space-y-3" id="laundry-list">
                    <!-- Dynamic -->
                </div>
            </div>
        </div>
    </div>

    <!-- TEMPLATE: Tourism Modal -->
    <div id="tourism-modal" class="fixed inset-0 z-[60] flex items-end justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/80 modal-backdrop" onclick="closeModal('tourism-modal')"></div>
        <div
            class="modal-content relative w-full h-[50vh] bg-stone-900 rounded-t-[2.5rem] overflow-hidden pointer-events-auto flex flex-col shadow-2xl">
            <div class="p-6 bg-stone-900 border-b border-white/10 flex justify-between items-center shrink-0">
                <h2 class="text-xl font-serif font-bold text-white flex items-center gap-2">
                    <i data-lucide="youtube" class="w-5 h-5 text-red-500"></i> Turismo en Ciudad Real
                </h2>
                <button onclick="closeModal('tourism-modal')"
                    class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center text-white hover:bg-white/20">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="flex-1 bg-black flex items-center justify-center relative">
                <iframe id="tourism-frame" class="w-full h-full absolute inset-0" src="" title="YouTube video player"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowfullscreen></iframe>
            </div>
        </div>
    </div>


    <!-- SCRIPTS -->
    <!-- SCRIPTS -->
    <script src="firebase-config.js"></script>
    <script type="module" src="db.js"></script>
    <script type="module">
        import { DB } from './db.js';

        // Globals for UI
        window.appData = null;

        async function initApp() {
            // Ensure Config Exists
            if (!window.firebaseConfig) {
                console.error("Firebase config missing!");
            }

            // Initialize DB with Config explicitly
            DB.init(window.firebaseConfig);

            try {
                window.appData = await DB.get();
                console.log("App Data Loaded:", window.appData);
                window.renderApp(); // Call the global render function
            } catch (e) {
                console.error("Error loading app data:", e);
                alert("Error cargando datos. Por favor recarga.");
            }
        }

        // Expose init logic if needed, or just run it
        initApp();

        // Listener for storage (for syncing across tabs/windows if Admin saves)
        window.addEventListener('storage', async () => {
            console.log("Storage changed, reloading...");
            window.appData = await DB.get();
            window.renderApp();
        });
    </script>
    <script>
        lucide.createIcons();

        // Global Render Function
        window.renderApp = function () {
            if (!window.appData) return;
            const appData = window.appData; // Local alias

            // 1. VISIBILITY CHECK
            const modules = ['info', 'minibar', 'laundry', 'tourism', 'spa', 'restaurante', 'roomService', 'cafeteria'];
            modules.forEach(mod => {
                const el = document.getElementById('module-' + mod);
                if (el && appData[mod]) {
                    // If active is explicitly false, hide it. Otherwise show.
                    // Default to true if undefined.
                    const isActive = appData[mod].active !== false;
                    el.style.display = isActive ? (el.tagName === 'BUTTON' || el.tagName === 'A' ? 'flex' : 'block') : 'none';

                    // Special case for grid parent of RS/Coffee if strictly needed, 
                    // but for now hiding the individual child is enough. 
                    // If both are hidden, the grid will be empty height.
                }
            });

            // Restaurante
            document.getElementById('restaurante-desc').textContent = `"${appData.restaurante.desc}"`;
            document.getElementById('restaurante-schedule').textContent = `Horario: ${appData.restaurante.schedule}`;

            // DAILY MENU LOGIC
            const rList = document.getElementById('restaurante-list');
            rList.innerHTML = ''; // Clear first because we append

            if (appData.restaurante.dailyMenu && appData.restaurante.dailyMenu.active) {
                const dm = appData.restaurante.dailyMenu;

                // Helper to format dishes with allergens
                // Regex looks for (numbers/numbers)
                const formatDish = (dish) => {
                    return dish.replace(/\(([\d\/]+)\)/g, (match, p1) => {
                        return `<span class="text-[10px] align-super text-stone-400 font-bold ml-1">(${p1})</span>`;
                    });
                };

                const dailyMenuHTML = `
                    <div class="bg-white p-6 md:p-12 shadow-xl border border-stone-100 mx-auto max-w-2xl relative">
                        
                        <!-- Top Logo -->
                        <div class="flex justify-start mb-8">
                            <img src="Imagenes/logo-cumbria.svg" class="h-16 opacity-80" alt="Cumbria Hotel">
                        </div>

                        <h2 class="text-4xl text-center font-bold text-stone-900 mb-8 italic">Menú del día</h2>

                        <!-- Starters -->
                        <div class="mb-8 text-center">
                            <h3 class="text-xl font-bold text-stone-800 mb-4 text-left">Primer plato para elegir:</h3>
                            <ul class="space-y-3">
                                ${(dm.starters || []).map(d => `
                                    <li class="font-serif italic text-xl text-stone-700 leading-relaxed">
                                        ${formatDish(d)}
                                    </li>
                                `).join('')}
                            </ul>
                        </div>

                        <!-- Mains -->
                        <div class="mb-10 text-center">
                            <h3 class="text-xl font-bold text-stone-800 mb-4 text-left">Segundo plato para elegir:</h3>
                            <ul class="space-y-3">
                                ${(dm.mains || []).map(d => `
                                    <li class="font-serif italic text-xl text-stone-700 leading-relaxed">
                                        ${formatDish(d)}
                                    </li>
                                `).join('')}
                            </ul>
                        </div>

                        <!-- Footer Info -->
                        <div class="text-right border-t pt-4 border-stone-200">
                            <p class="font-bold text-stone-800 text-sm mb-1">${(dm.includes || '').replace(/\n/g, '<br>')}</p>
                            <div class="flex justify-between items-end mt-4">
                                <!-- WhatsApp Share Button -->
                                <button onclick="shareDailyMenu()" class="inline-flex items-center gap-2 px-4 py-2 bg-[#25D366] text-white rounded-full text-xs font-bold uppercase tracking-wider hover:bg-green-600 transition shadow-sm card-press">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" class="w-4 h-4 brightness-0 invert">
                                    Enviar Menú
                                </button>
                                <p class="text-3xl font-bold text-stone-900">${dm.price} €</p>
                            </div>
                        </div>

                        <!-- Date -->
                        <div class="text-right mt-8 mb-8">
                            <p class="text-stone-500 italic font-serif text-lg">${dm.date}</p>
                        </div>
                        
                        <!-- Allergens Legend Img -->
                        <div class="mt-8 opacity-90 w-full">
                             <img src="Imagenes/Alergenos-removebg-preview.png" class="w-full object-contain">
                        </div>

                    </div>
                    
                    <div class="flex items-center justify-center gap-2 my-6 opacity-50">
                        <div class="h-[1px] w-12 bg-stone-300"></div>
                        <span class="text-xs text-stone-400 uppercase tracking-widest">Carta</span>
                        <div class="h-[1px] w-12 bg-stone-300"></div>
                    </div>
                `;
                rList.innerHTML += dailyMenuHTML;
            }

            // Categories (Carta)
            if (appData.restaurante.categories && appData.restaurante.showCarta !== false) {
                const catsHTML = appData.restaurante.categories.map((cat, catIdx) => `
                    <div class="bg-white p-6 rounded-3xl shadow-sm border border-stone-100">
                        <h3 class="text-xl font-serif font-bold text-amber-600 mb-4 border-b border-amber-100 pb-2">${cat.name}</h3>
                        <div class="space-y-4">
                            ${cat.items.map((item) => `
                                <div class="flex justify-between items-baseline group">
                                    <div class="pr-4">
                                        <h4 class="font-bold text-stone-800 group-hover:text-amber-600 transition">${item.name}</h4>
                                        <!-- <p class="text-xs text-stone-400">${item.desc || ''}</p> -->
                                        ${item.desc ? `<p class="text-xs text-stone-500 italic">${item.desc}</p>` : ''}
                                    </div>
                                    <div class="shrink-0 font-mono text-stone-600 font-bold">${item.price}€</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
                rList.innerHTML += catsHTML;
            }

            // renderCategories('restaurante-list', appData.restaurante.categories); // Removed old call

            // Room Service
            document.getElementById('rs-ext').textContent = `Extensión ${appData.roomService.ext}`;
            document.getElementById('rs-surcharge').textContent = `Suplemento servicio habitaciones: ${appData.roomService.surcharge}€`;
            renderCategories('rs-list', appData.roomService.categories);

            // Cafeteria
            document.getElementById('cafe-schedule').textContent = appData.cafeteria.schedule;
            renderSimpleList('cafe-list', appData.cafeteria.items);

            // Minibar
            if (appData.minibar.desc) {
                document.getElementById('minibar-desc').textContent = appData.minibar.desc;
                document.getElementById('minibar-desc').style.display = 'block';
            } else {
                document.getElementById('minibar-desc').style.display = 'none';
            }
            renderCategories('minibar-list', appData.minibar.categories);

            // Laundry
            // Laundry
            const lInfo = document.getElementById('laundry-info');
            if (lInfo) {
                if (appData.laundry.info) {
                    lInfo.innerHTML = appData.laundry.info.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    lInfo.style.display = 'block';
                } else {
                    lInfo.style.display = 'none';
                }
            }
            renderLaundryList('laundry-list', appData.laundry.categories || []);

            // Spa
            document.getElementById('spa-price-week').textContent = `${appData.spa.prices.week}€`;
            document.getElementById('spa-price-weekend').textContent = `${appData.spa.prices.weekend}€`;
            document.getElementById('spa-cap').textContent = appData.spa.prices.cap;
            document.getElementById('spa-flip').textContent = appData.spa.prices.flipflops;

            // Info (New)
            if (appData.info) {
                // Reception
                document.getElementById('info-reception-text').textContent = appData.info.reception.text;
                document.getElementById('info-reception-phone').textContent = appData.info.reception.phone;

                // Breakfast
                document.getElementById('info-breakfast-week').textContent = appData.info.breakfast.schedule_week;
                document.getElementById('info-breakfast-weekend').textContent = appData.info.breakfast.schedule_weekend;
                document.getElementById('info-breakfast-price').textContent = appData.info.breakfast.price;
                document.getElementById('info-breakfast-loc').textContent = appData.info.breakfast.location;

                // Pool & Gym
                document.getElementById('info-pool-desc').textContent = appData.info.pool.text;
                document.getElementById('info-pool-schedule').textContent = appData.info.pool.schedule;
                document.getElementById('info-gym-desc').textContent = appData.info.gym.text;
                document.getElementById('info-gym-schedule').textContent = `${appData.info.gym.schedule_week} | ${appData.info.gym.schedule_weekend}`;

                // Parking
                document.getElementById('info-parking-desc').textContent = appData.info.parking.text;

                // Others (Schedules)
                document.getElementById('info-restaurant-lunch').textContent = `Comidas: ${appData.info.restaurant.schedule_lunch}`;
                document.getElementById('info-restaurant-dinner').textContent = `Cenas: ${appData.info.restaurant.schedule_dinner}`;
                document.getElementById('info-cafeteria-schedule').textContent = appData.info.cafeteria.schedule;
                document.getElementById('info-roomservice-schedule').textContent = appData.info.roomService.schedule;
            }

            // Tourism
            if (appData.tourism) {
                if (appData.tourism.videoUrl) {
                    const tourFrame = document.getElementById('tourism-frame');
                    if (tourFrame) tourFrame.src = convertToEmbed(appData.tourism.videoUrl);
                }
                if (appData.tourism.desc) {
                    const tourDesc = document.getElementById('tourism-desc');
                    if (tourDesc) tourDesc.textContent = appData.tourism.desc;
                }
            }

            // Spa
            if (appData.spa) {
                if (appData.spa.headerImage) {
                    const spaImg = document.getElementById('spa-header-img');
                    if (spaImg) spaImg.src = appData.spa.headerImage;
                }
                if (appData.spa.videoUrl) {
                    const spaFrame = document.getElementById('spa-video-frame');
                    if (spaFrame) spaFrame.src = convertToEmbed(appData.spa.videoUrl);
                }
            }
        }

        // Helper to convert diverse YouTube URLs to Embed format
        // Helper to convert diverse YouTube URLs to Embed format
        function convertToEmbed(url) {
            if (!url) return '';

            // Already embed format?
            if (url.includes('/embed/')) return url;

            let videoId = '';

            try {
                // Handle https://youtu.be/ID
                if (url.includes('youtu.be/')) {
                    videoId = url.split('youtu.be/')[1].split(/[?&]/)[0];
                }
                // Handle https://www.youtube.com/watch?v=ID
                else if (url.includes('v=')) {
                    videoId = url.split('v=')[1].split(/[?&]/)[0];
                }
            } catch (e) {
                console.error("Error parsing YouTube URL:", url);
            }

            if (videoId) {
                return `https://www.youtube.com/embed/${videoId}?rel=0&modestbranding=1`;
            }

            return url; // Fallback
        }

        // Helpers for rendering
        function renderCategories(containerId, categories) {
            const container = document.getElementById(containerId);
            container.innerHTML = categories.map(cat => `
                <div class="bg-white rounded-3xl p-5 shadow-sm">
                    <h3 class="font-bold text-lg text-stone-800 mb-4 flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full bg-amber-500"></span> ${cat.name}
                    </h3>
                    <div class="space-y-4">
                        ${cat.items.map(item => `
                            <div>
                                <div class="flex gap-3 justify-between items-start">
                                    <div class="flex-1">
                                        <h4 class="font-bold text-stone-800 text-sm">
                                            ${item.name}
                                            ${item.allergens ? `<sup class="text-[10px] font-bold text-stone-400 ml-1">(${item.allergens})</sup>` : ''}
                                        </h4>
                                        ${item.desc ? `<p class="text-xs text-stone-500 mt-0.5 description-text">${item.desc.replace(/\(([\d\/,]+)\)/g, '<sup class="text-[10px] font-bold text-stone-400 ml-1">($1)</sup>')}</p>` : ''}
                                    </div>
                                    
                                    <!-- Image Thumbnail -->
                                    ${item.image ? `<div class="w-16 h-16 shrink-0 rounded-lg overflow-hidden bg-stone-100 ml-3"><img src="${item.image}" class="w-full h-full object-cover"></div>` : ''}

                                    <span class="font-bold text-amber-700 text-sm shrink-0 ml-2">${item.price}€</span>
                                </div>
                                <div class="w-full h-[1px] bg-stone-100 mt-2"></div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');

            // Add Allergen Legend at the bottom
            container.innerHTML += `
                <div class="mt-8 opacity-90 w-full px-4 text-center">
                    <p class="text-[10px] text-stone-400 mb-2 uppercase tracking-widest font-bold">Información de Alérgenos</p>
                    <img src="Imagenes/Alergenos-removebg-preview.png" class="w-full object-contain max-h-24 mx-auto style="mix-blend-mode: multiply;">
                </div>
            `;
        }

        function renderLaundryList(containerId, categories) {
            const container = document.getElementById(containerId);
            container.innerHTML = categories.map(cat => `
                <div class="bg-white rounded-3xl p-5 shadow-sm">
                    <h3 class="font-bold text-lg text-blue-900 mb-4 flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full bg-blue-500"></span> ${cat.name}
                    </h3>
                    
                    <!-- Header -->
                    <div class="grid grid-cols-12 gap-2 text-[10px] items-end font-bold text-stone-400 uppercase tracking-wider mb-2 border-b border-stone-100 pb-1">
                        <div class="col-span-6">Prenda</div>
                        <div class="col-span-3 text-right leading-tight">Lavado<br>& Plancha</div>
                        <div class="col-span-3 text-right leading-tight">Solo<br>Plancha</div>
                    </div>

                    <div class="space-y-3">
                        ${cat.items.map(item => `
                            <div class="grid grid-cols-12 gap-2 items-center text-sm">
                                <div class="col-span-6 font-bold text-stone-700 leading-tight">${item.name}</div>
                                <div class="col-span-3 text-right font-mono text-blue-600 font-bold bg-blue-50/50 rounded py-0.5 px-1">${item.priceWash}€</div>
                                <div class="col-span-3 text-right font-mono text-stone-500 bg-stone-50 rounded py-0.5 px-1">${item.priceIron}€</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function renderSimpleList(containerId, items) {
            const container = document.getElementById(containerId);
            if (!items) return;
            container.innerHTML = items.map(item => `
                <div class="price-dotted">
                    <span class="text-sm font-bold text-stone-800">${item.name}</span>
                    <span class="dots"></span>
                    <span class="text-sm font-bold text-stone-500">${item.price}€</span>
                </div>
             `).join('');
        }

        // Helper: Share Daily Menu via WhatsApp
        function shareDailyMenu() {
            const dm = appData.restaurante.dailyMenu;
            if (!dm) return;

            let phone = prompt("Introduce el teléfono del cliente (con código de país, ej: 34600123456):");
            // If user cancels, do nothing. If empty, fallback to generic share? 
            // User requested "al telefono que ponga", so if they cancel, we stop.
            if (phone === null) return;

            // Clean phone number (remove spaces, dashes)
            phone = phone.replace(/[^0-9]/g, '');

            let text = `🍽️ *Menú del Día - Restaurante Cumbria*\n📅 ${dm.date}\n\n`;

            text += `*Primeros:*\n`;
            dm.starters.forEach(d => text += `• ${d.split('(')[0].trim()}\n`);

            text += `\n*Segundos:*\n`;
            dm.mains.forEach(d => text += `• ${d.split('(')[0].trim()}\n`);

            text += `\n💰 Precio: ${dm.price}€\n`;
            text += `ℹ️ Incluye: ${dm.includes.replace(/\n/g, ' ')}\n`;
            text += `\n📍 *Hotel Cumbria*`;

            // If phone is empty, open generic picker, otherwise specific
            const url = phone ? `https://wa.me/${phone}?text=${encodeURIComponent(text)}` : `https://wa.me/?text=${encodeURIComponent(text)}`;
            window.open(url, '_blank');
        }

        // Admin Access
        function goToAdmin() {
            let user = prompt("Usuario Admin:", "admin");
            if (!user) return;

            user = user.trim().toLowerCase();

            if (user !== "admin" && user !== "administrador") {
                alert("Usuario no reconocido. Prueba con: admin");
                return;
            }

            const pass = prompt("Contraseña:");
            if (!pass) return;

            // Simple SHA-256 hash check to avoid plain text password
            sha256(pass).then(hash => {
                if (hash === "3fc0739dc16e977a01b14945df68f5d8e327844da476ee2ee8d586e00f214cb3") {
                    window.location.href = "admin.html";
                } else {
                    alert("Contraseña incorrecta");
                }
            });
        }

        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        // Initial Render not needed here, called by module

        // Listeners handled in module



        // ====== MODAL LOGIC ======
        function copyWifi() {
            const pass = "2016cumbria";
            navigator.clipboard.writeText(pass).then(() => {
                // Show custom toast/modal instead of alert
                const toast = document.createElement('div');
                toast.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-stone-900 text-white px-6 py-4 rounded-xl shadow-2xl z-[100] text-center space-y-2 fade-in-up';
                toast.innerHTML = `
                    <div class="flex justify-center mb-2"><i data-lucide="wifi" class="w-8 h-8 text-amber-500"></i></div>
                    <p class="font-bold text-lg">¡Contraseña Copiada!</p>
                    <p class="font-mono text-xl bg-white/10 px-3 py-1 rounded tracking-widest">${pass}</p>
                    <p class="text-xs text-stone-400 mt-2">Conéctate a la red: Cumbria_Guest</p>
                `;
                document.body.appendChild(toast);
                lucide.createIcons();

                setTimeout(() => {
                    toast.remove();
                }, 3000);
            }).catch(err => {
                alert("La contraseña es: " + pass);
            });
        }

        function openModal(id) {
            const modal = document.getElementById(id);
            if (!modal) return;

            const backdrop = modal.querySelector('.modal-backdrop');
            const content = modal.querySelector('.modal-content');

            modal.classList.remove('pointer-events-none');

            backdrop.classList.add('open');
            content.classList.add('open');

            document.body.style.overflow = 'hidden';
        }

        function closeModal(id) {
            const modal = document.getElementById(id);
            if (!modal) return;

            const backdrop = modal.querySelector('.modal-backdrop');
            const content = modal.querySelector('.modal-content');

            backdrop.classList.remove('open');
            content.classList.remove('open');

            setTimeout(() => {
                modal.classList.add('pointer-events-none');
                document.body.style.overflow = '';
            }, 300);
        }
    </script>
</body>

</html>