<!DOCTYPE html>
<html lang="es" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ciudad Real Experience | Cumbria Hotel</title>
    <link rel="icon" type="image/x-icon" href="Imagenes/Hotel Cumbria.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,800;1,400&family=Lato:wght@300;400;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Lato', sans-serif;
            background-color: #0c0a09;
            /* stone-950 */
            color: white;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }

        h1,
        h2,
        h3,
        .serif {
            font-family: 'Playfair Display', serif;
        }

        /* Hide Scrollbar */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-enter {
            opacity: 0;
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        .delay-100 {
            animation-delay: 0.1s;
        }

        .delay-200 {
            animation-delay: 0.2s;
        }

        .delay-300 {
            animation-delay: 0.3s;
        }

        /* Glass Cards */
        .glass-panel {
            background: rgba(28, 25, 23, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>

<body class="min-h-screen flex flex-col bg-stone-950 overflow-x-hidden selection:bg-amber-500 selection:text-white">

    <!-- Floating Back Button -->
    <div class="fixed top-6 left-6 z-50 animate-enter">
        <a href="index.html"
            class="w-12 h-12 rounded-full glass-panel flex items-center justify-center text-white hover:bg-white/10 transition group shadow-2xl">
            <i data-lucide="arrow-left" class="w-5 h-5 group-hover:-translate-x-1 transition duration-300"></i>
        </a>
    </div>

    <!-- HERO SECTION -->
    <div class="relative h-[50vh] md:h-[60vh] lg:h-[70vh] w-full overflow-hidden transition-all duration-700">
        <!-- Video Background -->
        <div class="absolute inset-0 z-0">
            <!-- Image Background (Hidden by default) -->
            <img id="tourism-img" src=""
                class="absolute inset-0 w-full h-full object-cover hidden transition-transform duration-[10s] hover:scale-105"
                alt="Background">

            <!-- Video Background -->
            <iframe id="tourism-frame"
                class="w-full h-[140%] -mt-[20%] object-cover opacity-60 scale-125 pointer-events-none hidden" src=""
                title="Background Video" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                referrerpolicy="strict-origin-when-cross-origin" allowfullscreen>
            </iframe>

            <div
                class="absolute inset-0 bg-gradient-to-b from-stone-950/30 via-stone-950/60 to-stone-950 pointer-events-none">
            </div>
            <!-- Vignette -->
            <div
                class="absolute inset-0 bg-[radial-gradient(circle_at_center,_transparent_0%,_#0c0a09_100%)] opacity-80">
            </div>
        </div>

        <!-- Hero Content -->
        <div
            class="absolute bottom-0 left-0 w-full p-6 md:p-12 pb-16 md:pb-24 z-10 flex flex-col items-start gap-4 md:gap-6">
            <div class="animate-enter delay-100">
                <span
                    class="px-3 py-1 rounded-full border border-amber-500/30 bg-amber-500/10 text-amber-500 text-[10px] md:text-xs font-bold uppercase tracking-[0.2em] backdrop-blur-md shadow-lg">
                    Gu√≠a Tur√≠stica Oficial
                </span>
            </div>
            <h1
                class="animate-enter delay-200 text-5xl md:text-8xl font-serif font-bold text-white leading-[0.9] drop-shadow-2xl max-w-4xl tracking-tight">
                Ciudad Real<br>
                <span class="text-stone-400 font-light italic text-4xl md:text-6xl tracking-normal">Experience
                    &trade;</span>
            </h1>
            <p
                class="animate-enter delay-300 text-stone-300 max-w-lg text-sm md:text-lg leading-relaxed drop-shadow-md border-l-2 border-amber-500 pl-4 md:pl-6">
                Descubra una tierra de gigantes, historia medieval y naturaleza salvaje.
                Una selecci√≥n exclusiva para hu√©spedes de Cumbria Hotel.
            </p>
        </div>
    </div>

    <!-- CONTENT WRAPPER -->
    <div class="relative z-20 -mt-12 md:-mt-20 px-4 md:px-12 pb-20 space-y-12 md:space-y-24 max-w-7xl mx-auto">

        <!-- INTRO CARD & VIDEO -->
        <div class="animate-enter delay-200 grid grid-cols-1 lg:grid-cols-12 gap-6">
            <!-- Text Card -->
            <div
                class="lg:col-span-8 glass-panel p-6 md:p-10 rounded-3xl relative overflow-hidden group border border-white/5 bg-stone-900/40 backdrop-blur-xl">
                <div
                    class="absolute top-0 right-0 p-8 opacity-5 md:opacity-10 group-hover:opacity-20 transition duration-700 pointer-events-none">
                    <i data-lucide="compass" class="w-32 h-32 md:w-48 md:h-48 text-amber-500 transform rotate-12"></i>
                </div>
                <h3 class="text-2xl md:text-3xl font-serif font-bold text-white mb-4 md:mb-6">Bienvenidos al Quijote
                </h3>
                <p id="tourism-desc"
                    class="text-stone-400 text-sm md:text-lg leading-relaxed mb-6 md:mb-8 text-justify relative z-10 font-light">
                    <!-- Text injected by JS -->
                </p>
                <div class="flex flex-wrap gap-4">
                    <a href="https://www.google.com/maps/search/Monumentos+Ciudad+Real" target="_blank"
                        class="px-4 py-2 rounded-full bg-white/5 hover:bg-white/10 border border-white/10 flex items-center gap-2 text-xs md:text-sm font-bold text-stone-300 hover:text-white transition uppercase tracking-wider">
                        <i data-lucide="landmark" class="w-4 h-4 text-indigo-400"></i> Cultura
                    </a>
                    <a href="https://www.google.com/maps/search/Shopping+Ciudad+Real" target="_blank"
                        class="px-4 py-2 rounded-full bg-white/5 hover:bg-white/10 border border-white/10 flex items-center gap-2 text-xs md:text-sm font-bold text-stone-300 hover:text-white transition uppercase tracking-wider">
                        <i data-lucide="shopping-bag" class="w-4 h-4 text-pink-400"></i> Shopping
                    </a>
                </div>
            </div>

            <!-- Promo Video Mini -->
            <div
                class="lg:col-span-4 relative h-64 lg:h-auto rounded-3xl overflow-hidden glass-panel group cursor-pointer border-0 ring-1 ring-white/10 ring-offset-2 ring-offset-stone-950 shadow-2xl">
                <iframe id="promo-frame"
                    class="absolute inset-0 w-full h-full object-cover opacity-80 group-hover:opacity-100 transition duration-500 scale-105 group-hover:scale-110"
                    src="" title="Promo" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen></iframe>
                <div
                    class="absolute inset-0 pointer-events-none flex items-center justify-center bg-black/20 group-hover:bg-transparent transition">
                    <div
                        class="w-16 h-16 rounded-full bg-white/10 backdrop-blur-md border border-white/20 flex items-center justify-center shadow-lg group-hover:scale-110 transition">
                        <i data-lucide="play" class="w-6 h-6 fill-white text-white ml-1"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- EXCURSIONS MASONRY -->
        <div class="space-y-8">
            <div
                class="flex flex-col md:flex-row items-start md:items-end justify-between px-2 animate-enter delay-300 border-b border-white/10 pb-4 gap-4">
                <div>
                    <span
                        class="text-amber-500 text-[10px] md:text-xs font-bold uppercase tracking-widest block mb-2">Destinos</span>
                    <h2 class="text-3xl md:text-4xl font-serif font-bold text-white">Experiencias √önicas</h2>
                </div>

                <!-- Filters -->
                <div id="filter-container" class="flex flex-wrap gap-2">
                    <!-- Injected via JS -->
                </div>
            </div>

            <div id="excursions-grid"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8 animate-enter delay-300">
                <!-- Injected via JS -->
            </div>
        </div>

        <!-- FOOTER MAP -->
        <div class="animate-enter delay-300 pt-12 pb-16 text-center border-t border-white/5">
            <a href="https://www.google.com/maps/search/Turismo+Ciudad+Real" target="_blank"
                class="inline-flex flex-col items-center gap-4 group opacity-60 hover:opacity-100 transition duration-300">
                <div
                    class="w-16 h-16 rounded-full border border-dashed border-stone-600 group-hover:border-amber-500 flex items-center justify-center text-stone-500 group-hover:text-amber-500 transition bg-stone-900/50">
                    <i data-lucide="map-pin" class="w-6 h-6"></i>
                </div>
                <span
                    class="text-xs md:text-sm uppercase tracking-widest text-stone-400 group-hover:text-white transition font-bold">Explorar
                    Mapa General</span>
            </a>
        </div>
    </div>

    <!-- Scripts -->
    <script src="db.js?v=5" type="module"></script>
    <script type="module">
        import { DB } from './db.js?v=5';

        lucide.createIcons();

        (async function init() {
            const appData = await DB.get();
            console.log("üìä Tourism Data Loaded:", appData?.tourism);
            console.log("üì∏ Excursions:", appData?.tourism?.excursions?.map(e => ({ title: e.title, hasImage: !!e.image, image: e.image })));

            if (appData && appData.tourism) {
                render(appData.tourism);
            } else {
                console.error("‚ùå No tourism data found!");
            }
        })();

        function render(data) {
            // 1. Hero (Video or Image)
            const tFrame = document.getElementById('tourism-frame');
            const tImg = document.getElementById('tourism-img');

            if (data.coverImage) {
                // Show Image, Hide Video
                tImg.src = data.coverImage;
                tImg.classList.remove('hidden');
                tFrame.classList.add('hidden');
            } else if (data.videoUrl) {
                // Show Video, Hide Image
                let src = data.videoUrl;
                if (src.includes('drive.google.com')) {
                    // Google Drive: convert /view to /preview
                    src = src.replace('/view?usp=sharing', '/preview').replace('/view', '/preview');
                } else if (src.includes('vimeo')) {
                    // Vimeo embed parameters
                    src += "?background=1&autoplay=1&loop=1&byline=0&title=0";
                } else if (src.includes('youtube') || src.includes('youtu.be')) {
                    // YouTube embed parameters
                    src += "&autoplay=1&mute=1&loop=1&playlist=lE6RYpe9IT0&controls=0&showinfo=0";
                }
                // If none match, use URL as-is
                tFrame.src = src;
                tFrame.classList.remove('hidden');
                tImg.classList.add('hidden');
            }
            // 2. Desc
            const tDesc = document.getElementById('tourism-desc');
            tDesc.innerText = data.desc || "Explora...";

            // 3. Promo
            const pFrame = document.getElementById('promo-frame');
            if (data.videoUrlPromo) {
                let promoSrc = data.videoUrlPromo;
                if (promoSrc.includes('drive.google.com')) {
                    promoSrc = promoSrc.replace('/view?usp=sharing', '/preview').replace('/view', '/preview');
                }
                pFrame.src = promoSrc;
            }

            // 4. Grid & Filters
            const grid = document.getElementById('excursions-grid');
            const filterContainer = document.getElementById('filter-container');

            grid.innerHTML = '';
            filterContainer.innerHTML = '';

            if (data.excursions && data.excursions.length > 0) {
                // Collect Unique Types
                const uniqueTypes = [...new Set(data.excursions.map(item => item.type || 'Otros').filter(t => t))];

                // Sort Types: Todos -> Ciudad Real -> Provincia -> Others
                const types = ['Todos', ...uniqueTypes.filter(t => t !== 'Todos').sort((a, b) => {
                    const priority = ['Ciudad Real', 'Provincia'];
                    const idxA = priority.findIndex(p => a.toLowerCase().includes(p.toLowerCase()));
                    const idxB = priority.findIndex(p => b.toLowerCase().includes(p.toLowerCase()));

                    if (idxA !== -1 && idxB !== -1) return idxA - idxB;
                    if (idxA !== -1) return -1;
                    if (idxB !== -1) return 1;

                    return a.localeCompare(b);
                })];

                // Render Filters
                types.forEach(type => {
                    const btn = document.createElement('button');
                    btn.textContent = type;
                    btn.className = `px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider border transition ${type === 'Todos' ? 'bg-amber-500 text-stone-900 border-amber-500' : 'bg-transparent text-stone-400 border-stone-700 hover:border-amber-500 hover:text-white'}`;

                    btn.onclick = () => {
                        // Update Active State
                        Array.from(filterContainer.children).forEach(b => {
                            b.className = `px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider border transition bg-transparent text-stone-400 border-stone-700 hover:border-amber-500 hover:text-white`;
                        });
                        btn.className = `px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider border transition bg-amber-500 text-stone-900 border-amber-500`;

                        // Filter Grid
                        const cards = grid.children;
                        Array.from(cards).forEach(card => {
                            if (type === 'Todos' || card.dataset.type === type) {
                                card.classList.remove('hidden');
                                card.classList.add('block');
                            } else {
                                card.classList.add('hidden');
                                card.classList.remove('block');
                            }
                        });
                    };
                    filterContainer.appendChild(btn);
                });

                data.excursions.forEach((item, index) => {
                    if (!item.id) return; // Skip items with missing ID

                    const el = document.createElement('a');
                    el.href = `excursion.html?id=${item.id}`;
                    el.dataset.type = item.type || 'Otros';
                    // Responsive heights: h-80 mobile, h-96 desktop
                    el.className = "block relative w-full h-80 md:h-96 rounded-[2rem] overflow-hidden group shadow-2xl transition hover:shadow-amber-900/20 card-hover brightness-90 hover:brightness-100 ring-1 ring-white/5";

                    const colors = {
                        amber: 'text-amber-400 bg-amber-500',
                        emerald: 'text-emerald-400 bg-emerald-500',
                        rose: 'text-rose-400 bg-rose-500',
                        blue: 'text-blue-400 bg-blue-500',
                        indigo: 'text-indigo-400 bg-indigo-500'
                    };
                    const colorSet = colors[item.color] || colors.amber;
                    const textColor = colorSet.split(' ')[0];
                    const bgColor = colorSet.split(' ')[1];

                    el.innerHTML = `
                        <!-- Image -->
                        <img src="${item.image}" class="absolute inset-0 w-full h-full object-cover transition duration-1000 group-hover:scale-105">
                        <div class="absolute inset-0 bg-gradient-to-t from-stone-950 via-stone-950/40 to-transparent opacity-90 transition duration-500 group-hover:opacity-80"></div>
                        
                        <!-- Content -->
                        <div class="absolute bottom-0 left-0 w-full p-8 flex flex-col items-start gap-2 translate-y-2 group-hover:translate-y-0 transition duration-500">
                            <div class="flex items-center gap-2 mb-1 opacity-0 group-hover:opacity-100 transition duration-500 -translate-y-2 group-hover:translate-y-0">
                                <span class="w-8 h-[2px] ${bgColor}"></span>
                                <span class="text-[10px] font-bold uppercase tracking-widest text-stone-300">${item.type || 'Experiencia'}</span>
                            </div>
                            <h3 class="text-3xl font-serif font-bold text-white leading-none shadow-black drop-shadow-lg group-hover:text-amber-50 transition duration-300">
                                ${item.title}
                            </h3>
                            <p class="text-stone-400 text-sm italic font-serif opacity-80 group-hover:opacity-100 transition">${item.subtitle || ''}</p>
                        </div>
                        
                        <!-- Floating Action -->
                        <div class="absolute top-6 right-6 w-12 h-12 rounded-full glass-panel flex items-center justify-center text-white/50 group-hover:text-white group-hover:bg-white/20 transition border border-white/10 group-active:scale-95 opacity-0 group-hover:opacity-100 transform translate-y-2 group-hover:translate-y-0 duration-300">
                            <i data-lucide="arrow-up-right" class="w-5 h-5"></i>
                        </div>
                    `;

                    grid.appendChild(el);
                });
            } else {
                grid.innerHTML = '<p class="text-stone-500 text-center col-span-full py-10">Pr√≥ximamente nuevas experiencias.</p>';
            }

            lucide.createIcons();
        }
    </script>
</body>

</html>